# 본문의 글은 인프런 앨런 Swift문법 마스터 스쿨(온라인) 부트캠프의 강의 영상을 본후 공부한 내용을 정리하여 기록한것입니다.
https://inf.run/YyoR


#  저장속성(Stored Properties)    

값이 저장되는 일반적인 속성(변수)을 저장 속성이라고 함   
```swift

// 그동안 우리가 배운 속성은 정확한 의미에서 "저장 속성"이었음


struct Bird {
    var name: String  //저장 속성
    var weight: Double //저장 속성
    
    init(name: String, weight: Double) {    // 기본값이 없으면, 생성자를 통해 값을 반드시 초기화해야함
        self.name = name
        self.weight = weight
    }
    
    func fly() {
        print("날아갑니다.")
    }
}



var aBird = Bird(name: "참새1", weight: 0.2)

aBird.name
aBird.weight



var bBird = Bird(name: "참새2", weight: 0.3)

bBird.name
bBird.weight
```
1. 저장 속성 ===> 구조체, 클래스 동일       
2. let(상수) 또는 var(변수)로 선언 가능    
   (만약 저장 속성을 let으로 선언하면 값을 바꿀 수 없음)    
3. 저장 속성(변수)은 각 속성자체가 고유의 메모리 공간을 가짐   
4. (앞에서 배웠던 것처럼) 초기화 이전에 값을 가지고 있거나, 생성자 메서드를 통해 값을 반드시 초기화 해야만 함    


# 지연 저장 속성
```swift

struct Bird1 {
    var name: String
    lazy var weight: Double = 0.2 //앞에 lazy 를 붙히면 지연저장속성이 됨. 지연저장속성은 처음부터 메모리를 가지지 않는다. lazy는 선언 시점에 값을 가져야함
    //이 속성에 접근하는 시점에서 메모리공간이 생기고 숫자가 저장됨. 어쩔때는 굳이 메모리공간을 차지하지않게 하는경우가 있는데 그때 쓰는것.
    
    init(name: String) {
        self.name = name
        //self.weight = 0.2
    }
    
    func fly() {
        print("날아갑니다.")
    }
}



var aBird1 = Bird1(name: "새")   // weight 속성 초기화 안됨
aBird1.weight  // <============ 이렇게 접근하는 순간 초기화됨(메모리공간이생기고 값이저장)

```

저장 속성은 저장 속성인데, 지연(lazy)의 의미가 뭘까?    
지연 저장 속성은 "해당 저장 속성"의 초기화를 지연시키는 것임   
즉, 인스턴스가 초기화되는 시점에 해당 속성이 값을 갖고 초기화되는    
것이 아니라(메모리에 공간과 값을 갖는 것이 아니라),     
해당 속성(변수)에 접근하는 순간에 (해당 저장 속성만)개별적으로 초기화됨    
    
따라서, 상수로의 선언은 안되고 변수(var)로의 선언만 가능
lazy var만 가능(lazy let 불가능)    
   
즉, 위의 weight이라는 속성은 초기화 시점에 메모리 공간이 생기는 것이 아님   
예를 들어, 인스턴스가 생기고 난 후, aBird.weight 이렇게 접근하는   
순간 메모리 공간을 만들고 숫자를 저장 하게됨    



지연 저장 속성은 "선언시점에 기본값을 저장"해야함   
따라서, 생성자에서 초기화를 시키지 않기 때문에 "선언시점에 기본값을 저장"해야함    
지연(lazy) 저장 속성 ===> 구조체, 클래스 동일    
값을 넣거나, 함수 실행문을 넣을수 있음(모든 형태의 표현식)    
함수호출 코드, 계산코드, 클로저 코드 등도 모두 가능   ===> 저장하려는 속성과 "리턴형"만 일치하면 됨     
지연 저장 속성으로 선언된  "해당 속성"의 초기화 지연 ===> 메모리 공간이 없다가 처음 접근하는 순간에 (해당 속성만)개별적으로 초기화됨   

# 실제, 지연 저장 속성을 사용하는 이유?

```swift
class AView {
    var a: Int
    
    // 1) 메모리를 많이 차지할때
    lazy var view = UIImageView()     // 이미지같이 무거운 속성을 저장할때
    
    // 2) 다른 속성을 이용해야할때(다른 저장 속성에 의존해야만 할때)
    lazy var b: Int = { //아직 안배운 클로저 라는건데 b라는 속성은 a라는 속성에 10을 곱한다는건데. a라는 저장속성에 의존하는것이다. a가 먼저 저장되어야 하는 어떤 순서가 있는것 그래서 이런 순서를 위해 b를 지연저장속성으로 좀 지연시켜서 순서를 맞춰주는것이다.
        return a * 10
    }()
    
    init(num: Int) {
        self.a = num
    }
}
```
지연 저장 속성을 사용하는 이유

1. 메모리 공간을 많이 차지하는 이미지 등의 속성에 저장할때,(반드시 메모리에 다 올릴 필요가 없으므로) 지연 저장 속성으로 선언 함 (메모리 낭비 막기 위함)    

2. 다른 속성들을 이용해야 할때 초기화 시점에 모든 속성들이 동시에 메모리 공간에 저장되므로 어떤 한가지 속성이 다른 속성에 접근할 수가 없다. (그렇지만, 지연 저장 속성을 이용 하는 경우 지연으로 저장된 속성은 먼저 초기화된 속성에 접근 할 수 있게됨)    

